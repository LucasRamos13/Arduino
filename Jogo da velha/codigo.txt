#include <Keypad.h>
#include <Adafruit_NeoPixel.h>

#define PIN 12
#define NUMPIXELS 9
Adafruit_NeoPixel pixels = Adafruit_NeoPixel(NUMPIXELS, PIN, NEO_GRB + NEO_KHZ800);
int j = 0;
int vit = 0;
int ar[10] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

const byte numRows= 4; 
const byte numCols= 4; 

char keymap[numRows][numCols]= 
{
{'1', '2', '3', 'A'}, 
{'4', '5', '6', 'B'}, 
{'7', '8', '9', 'C'},
{'*', '0', '#', 'D'}
};

byte rowPins[numRows] = {9,8,7,6}; 
byte colPins[numCols]= {5,4,3,2}; 


Keypad myKeypad= Keypad(makeKeymap(keymap), rowPins, colPins, numRows, numCols);

void setup()
{
Serial.begin(9600);
  pixels.begin();
  for (int i=0; i < NUMPIXELS; i++) {
    pixels.setPixelColor(i, pixels.Color(55, 55, 255));
    pixels.show();
  	}
  pinMode(10, OUTPUT);
  pinMode(11, OUTPUT);
  pinMode(13, OUTPUT);
}

void loop()
{
char keypressed = myKeypad.getKey();
if (keypressed != NO_KEY)
{
 int Clebinho = keypressed - '0';
  if(ar[Clebinho] != 0){
	}else if (j==0){
   ar[Clebinho] = 1;
    j++;
  }else{
  ar[Clebinho] = 2;
    j=0;
  }
  for (int i=0; i < 10; i++) {
    if (ar[i]==1){
        pixels.setPixelColor(i-1, pixels.Color(255, 55, 55));
    }else if(ar[i]==2){ pixels.setPixelColor(i-1, pixels.Color(55, 255, 55));}
    else{pixels.setPixelColor(i, pixels.Color(55, 55, 255));};
    pixels.show();}
  
  if (ar[1] == ar[2] && ar[1] == ar[3] && ar[1]!=0){vit = ar[1];}
  if (ar[4] == ar[5] && ar[4] == ar[6] && ar[4]!=0){vit = ar[4];}
  if (ar[7] == ar[8] && ar[7] == ar[9] && ar[7]!=0){vit = ar[7];}
  if (ar[1] == ar[4] && ar[1] == ar[7] && ar[1]!=0){vit = ar[1];}
  if (ar[2] == ar[5] && ar[2] == ar[8] && ar[2]!=0){vit = ar[2];}
  if (ar[3] == ar[6] && ar[3] == ar[9] && ar[3]!=0){vit = ar[3];}
  if (ar[1] == ar[5] && ar[1] == ar[9] && ar[1]!=0){vit = ar[1];}
  if (ar[3] == ar[5] && ar[3] == ar[7] && ar[3]!=0){vit = ar[3];}
  Serial.println(vit);
  if (vit != 0){
  digitalWrite(9+vit, HIGH);
  for (int i=0; i < 10; i++) {
    pixels.setPixelColor(i, pixels.Color(55, 55, 255));
    pixels.show();
  ar[i] = 0;}
  delay(3000);
  digitalWrite(9+vit, LOW);
  }else{
    int cab = 0;
    for (int i=0; i < 10; i++) {
      if (ar[i] == 0){cab++;}
      if (cab == 0){
      digitalWrite(13, HIGH);
      for (int i=0; i < 10; i++) {
    pixels.setPixelColor(i, pixels.Color(55, 55, 255));
    pixels.show();
  	ar[i] = 0;}
  	delay(3000);
  	digitalWrite(13, LOW);}
    }
  }
}
}
